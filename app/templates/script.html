<script>
    $(document).ready(function() {
        // Configuração da duração das mensagens de alerta
        // Permite que a mensagem se feche sozinha após um determinado tempo
        setTimeout(function() {
            $(".alert-dismissable").alert('close');
        }, 5000);  // 5 Segundos
        
        // Configuração do DataTables
        // Todas as tabelas da página inicial fazem uso dessa configuração
        var table = $('#table-solicitacoes').DataTable({
            /* Recebimento de dados via API
            ajax: '/api/solicitacoes',
            columns: [
                {data: 'id'},
                {data: 'data_abertura'},
                {data: 'tipo'},
                {data: 'turno_id'},
                {data: 'usuario_id'},
                {data: 'status'},
                {data: 'descricao'}
            ], 
            */
            // Ajustes das colunas
            columnDefs: [ {
                orderable: false,
                className: 'select-checkbox',
                targets:   0
            } ],
            select: {
                style:    'os',
                selector: 'td:first-child'
            },
            columns: [
                {width: '3%'},
                {width: '3%'},
                {width: '15%'},
                {width: '15%'},
                {width: '15%'},
                {width: '15%'},
                {width: '15%'},
                {width: '100px'}
            ],
            // Propriedades da tabela
            responsive: true,
            colReorder: true,
            lengthChange: true,
            fixedHeader: true,
            autoWidth: false,
            "lengthMenu": [[25, 50, 75, 100], [25, 50, 75, 100]],
            "order": [[ 1, "desc" ]],
            dom: "<'row'<'col-md-12 col-lg-4'l><'col-md-12 col-lg-4'B><'col-md-12 col-lg-4'f>>" +
                 "<'row'<'col-md-12'tr>>" +
                 "<'row'<'col-md-12 col-lg-5'i><'col-md-12 col-lg-7'p>>",
            // Butões de funções
            buttons: [
                {
                    extend: 'excelHtml5',
                    text: 'Excel',
                    autoFilter: true,
                    exportOptions: {
                        columns: [1, 2, 3, 4, 5, 6]
                    }
                },
                {
                    extend: 'csvHtml5',
                    text: 'CSV',
                    exportOptions: {
                        columns: [1, 2, 3, 4, 5, 6]
                    }
                },
                {
                    extend: 'pdfHtml5',
                    orientation: 'portrait',
                    pageSize: 'A4',
                    text: 'PDF',
                    exportOptions: {
                        columns: [1, 2, 3, 4, 5, 6]
                    }
                },
                {
                    extend: 'print',
                    text: 'Imprimir',
                    exportOptions: {
                        columns: [1, 2, 3, 4, 5, 6]
                    }
                },
                {
                    extend: 'colvis',
                    text: 'Colunas'
                }, 
            ],
            // Localização dos textos
            "language": {
                "emptyTable": "Nenhum registro encontrado",
                "info": "Mostrando de _START_ até _END_ de _TOTAL_ registros",
                "infoEmpty": "Mostrando 0 até 0 de 0 registros",
                "infoFiltered": "(Filtrados de _MAX_ registros)",
                "infoThousands": ".",
                "loadingRecords": "Carregando...",
                "processing": "Processando...",
                "zeroRecords": "Nenhum registro encontrado",
                "search": "Pesquisar",
                "lengthMenu": "Exibir _MENU_",
                "decimal": ",",
                "thousands": ".",
                "paginate": {
                    "next": "Próximo",
                    "previous": "Anterior",
                    "first": "Primeiro",
                    "last": "Último"
                },
                select: {
                    rows: {
                        _: "%d registros selecionados",
                        0: "Nenhum registro selecionado",
                        1: "1 registro selecionado"
                    }
                }
            }
        });
        var table = $('table.display').DataTable({
            // Ajustes das colunas
            columnDefs: [ {
                orderable: false,
                className: 'select-checkbox',
                targets:   0
            } ],
            select: {
                style:    'os',
                selector: 'td:first-child'
            },
            columns: [
                {width: '3%'},
                {width: '3%'},
                {width: '15%'},
                {width: '20%'},
                {width: '20%'},
                {width: '20%'},
                {width: '100px'}
            ], 
            // Propriedades da tabela
            responsive: true,
            colReorder: true,
            lengthChange: true,
            fixedHeader: true,
            autoWidth: false,
            "lengthMenu": [[25, 50, 75, 100], [25, 50, 75, 100]],
            "order": [[ 1, "desc" ]],
            dom: "<'row'<'col-md-12 col-lg-4'l><'col-md-12 col-lg-4'B><'col-md-12 col-lg-4'f>>" +
                 "<'row'<'col-md-12'tr>>" +
                 "<'row'<'col-md-12 col-lg-5'i><'col-md-12 col-lg-7'p>>",
            // Butões de funções
            buttons: [
                {
                    extend: 'excelHtml5',
                    text: 'Excel',
                    autoFilter: true,
                    exportOptions: {
                        columns: [1, 2, 3, 4, 5]
                    }
                },
                {
                    extend: 'csvHtml5',
                    text: 'CSV',
                    exportOptions: {
                        columns: [1, 2, 3, 4, 5]
                    }
                },
                {
                    extend: 'pdfHtml5',
                    orientation: 'portrait',
                    pageSize: 'A4',
                    text: 'PDF',
                    exportOptions: {
                        columns: [1, 2, 3, 4, 5]
                    }
                },
                {
                    extend: 'print',
                    text: 'Imprimir',
                    exportOptions: {
                        columns: [1, 2, 3, 4, 5]
                    }
                },
                {
                    extend: 'colvis',
                    text: 'Colunas'
                }, 
            ],
            // Localização dos textos
            "language": {
                "emptyTable": "Nenhum registro encontrado",
                "info": "Mostrando de _START_ até _END_ de _TOTAL_ registros",
                "infoEmpty": "Mostrando 0 até 0 de 0 registros",
                "infoFiltered": "(Filtrados de _MAX_ registros)",
                "infoThousands": ".",
                "loadingRecords": "Carregando...",
                "processing": "Processando...",
                "zeroRecords": "Nenhum registro encontrado",
                "search": "Pesquisar",
                "lengthMenu": "Exibir _MENU_",
                "decimal": ",",
                "thousands": ".",
                "paginate": {
                    "next": "Próximo",
                    "previous": "Anterior",
                    "first": "Primeiro",
                    "last": "Último"
                },
                select: {
                    rows: {
                        _: "%d registros selecionados",
                        0: "Nenhum registro selecionado",
                        1: "1 registro selecionado"
                    }
                }
            }
        });
        // Correção de responsividade das tabelas ao trocar de abas
        $('a[data-toggle="pill"]').on('shown.bs.tab', function(e){
            $.fn.dataTable.tables( {visible: true, api: true} )
            .responsive.recalc()
            .columns.adjust();
        });   
        // Configuração dos campos que o usam o Select2
        // Os campos de seleção de sala/equipamento em solicitações fazem uso dele
        $('#salas').select2({
            placeholder: "Salas Disponíveis",
            theme: "bootstrap",
            allowClear: false,
            "language": {
                "noResults": function(){
                    return "Nenhuma sala encontrada";
                }
            },
            "width": '100%'
        });
        $('#equipamentos').select2({
            placeholder: "Equipamentos Disponíveis",
            theme: "bootstrap",
            allowClear: false,
            "language": {
                "noResults": function(){
                    return "Nenhum equipamento encontrado";
                }
            },
            "width": '100%'
        });
    } );
</script>