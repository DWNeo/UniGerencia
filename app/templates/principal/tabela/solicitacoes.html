<!-- Tabela para rederização de Solicitações -->
<table id="table-solicitacoes" class="table display dt-responsive table-hover table-responsive-md" style="width:100%;height:100%">
    <thead>
    <!-- Colunas da Tabela -->
    <tr class="bg-primary text-light">
        <th class="align-middle">#</th>
        <th class="align-middle">Data de Abertura</th>
        <th class="align-middle">Tipo</th>
        <th class="align-middle">Turno</th>
        <th class="align-middle">Autor</th>
        <th class="align-middle">Status</th>
        <th class="align-middle">Ações</th>
    </tr>
    </thead>
    <tbody>
    <!-- Cria uma nova linha pra cada registro de solicitação ativa -->
    {% for solicitacao in solicitacoes %}
    <!-- Exibe os registros somente para o autor ou para os admins-->
    {% if current_user == solicitacao.autor or current_user.admin == True %}
        <!-- Muda a cor da linha e texto de acordo com o status -->
        {% if solicitacao.status == 'Em Aberto' %}
            <tr class="table-secondary">
        {% elif solicitacao.status == 'Em Atraso' %}
            <tr class="table-danger text-danger">
        {% elif solicitacao.status == 'Em Espera' %}
            <tr class="table-warning text-warning">
        {% elif solicitacao.status == 'Confirmada' %}
            <tr class="table-success text-success">
        {% elif solicitacao.status == 'Em Uso' %}
            <tr class="table-info text-info">
        {% elif solicitacao.status == 'Cancelada' or solicitacao.status == 'Finalizada' %}
            <tr class="text-secondary">
        {% else %}
            <tr>
        {% endif %}
            <!-- Linhas da Tabela -->
            <td class="align-middle">{{ solicitacao.id }}</td>
            <td class="align-middle">{{ solicitacao.data_abertura.strftime('%d/%m/%Y %H:%M:%S') }}</td>
            <td class="align-middle">{{ solicitacao.tipo }}</td>
            <td class="align-middle">{{ solicitacao.turno }}</td>
            <td class="align-middle">{{ solicitacao.autor.nome }}</td>
            <td class="align-middle">{{ solicitacao.status }}</td>
            <td class="align-middle">
                <!-- Botões de Ação-->
                <!-- A visibilidade varia com o status e usuário -->
                <a class="btn-lg btn-outline-info" href="#" data-toggle="modal" data-target="#visualizarSolicitacao{{ solicitacao.id }}"><i class="fas fa-search"></i></a> 
                {% if current_user.admin == True %}
                    {% if solicitacao.status == 'Em Aberto' or solicitacao.status == 'Em Espera' %}
                        <a class="btn-lg btn-outline-success" href="{{ url_for('solicitacoes.confirma_solicitacao', solicitacao_id=solicitacao.id) }}"><i class="fas fa-check-square"></i></a>
                    {% endif %}
                    {% if solicitacao.status == 'Confirmada' %}
                        <a class="btn-lg btn-outline-primary" href="#" data-toggle="modal" data-target="#entregarSolicitacao{{ solicitacao.id }}"><i class="fas fa-upload"></i></a>
                    {% endif %}
                    {% if solicitacao.status == 'Em Uso' or solicitacao.status == 'Em Atraso' %}
                        <a class="btn-lg btn-outline-primary" href="#" data-toggle="modal" data-target="#receberSolicitacao{{ solicitacao.id }}"><i class="fas fa-download"></i></a>
                    {% endif %}
                {% endif %}
                {% if current_user == solicitacao.autor or current_user.admin == True %}
                    {% if solicitacao.status == 'Em Aberto' or solicitacao.status == 'Confirmada' %}
                        <a class="btn-lg btn-outline-warning" href="#" data-toggle="modal" data-target="#cancelarSolicitacao{{ solicitacao.id }}"><i class="fas fa-window-close"></i></a>
                    {% endif %}
                {% endif %}
                {% if current_user.admin == True %}
                    <a class="btn-lg btn-outline-danger" href="#" data-toggle="modal" data-target="#excluirSolicitacao{{ solicitacao.id }}"><i class="fas fa-trash"></i></a>
                {% endif %}
            </td>
        </tr>
        <!-- Modals Inclusos -->
        {% include 'principal/modal/visualizar_solicitacao.html' %}
        {% include 'principal/modal/entregar_solicitacao.html' %}
        {% include 'principal/modal/receber_solicitacao.html' %}
        {% include 'principal/modal/cancelar_solicitacao.html' %}
        {% include 'principal/modal/excluir_solicitacao.html' %}
    {% endif %}
    {% endfor %}
    </tbody>
</table>